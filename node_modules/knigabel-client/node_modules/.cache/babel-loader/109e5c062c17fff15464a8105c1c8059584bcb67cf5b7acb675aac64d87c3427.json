{"ast":null,"code":"import axios from 'axios';\n\n// Configure axios defaults\naxios.defaults.baseURL = process.env.REACT_APP_API_URL || 'http://localhost:3000';\naxios.defaults.timeout = 10000;\n\n// Add request interceptor for authentication\naxios.interceptors.request.use(config => {\n  // Add auth token if available\n  const token = localStorage.getItem('token');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// Add response interceptor for error handling\naxios.interceptors.response.use(response => response, error => {\n  var _error$response;\n  if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401) {\n    // Handle unauthorized access\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    window.location.href = '/';\n  }\n  return Promise.reject(error);\n});\nexport const initializeApp = async () => {\n  try {\n    // Fetch initial library data\n    const [booksResponse, genresResponse, statsResponse] = await Promise.all([axios.get('/api/books'), axios.get('/api/genres'), axios.get('/api/stats')]);\n    return {\n      books: booksResponse.data.books || [],\n      genres: genresResponse.data || [],\n      stats: statsResponse.data || {},\n      pagination: booksResponse.data.pagination || null\n    };\n  } catch (error) {\n    console.error('Failed to initialize app:', error);\n\n    // Return mock data if API is not available\n    return {\n      books: [],\n      genres: ['Все жанры', 'Роман-эпопея', 'Фантастика', 'Детектив'],\n      stats: {\n        totalBooks: 0,\n        availableBooks: 0,\n        borrowedBooks: 0,\n        totalGenres: 4\n      }\n    };\n  }\n};\nexport const apiService = {\n  // Books\n  getBooks: (params = {}) => axios.get('/api/books', {\n    params\n  }),\n  getBook: id => axios.get(`/api/books/${id}`),\n  getBookContent: id => axios.get(`/api/books/${id}/content`),\n  searchBooks: query => axios.get('/api/books/search', {\n    params: {\n      q: query\n    }\n  }),\n  filterBooks: genre => axios.get('/api/books/filter', {\n    params: {\n      genre\n    }\n  }),\n  borrowBook: id => axios.post(`/api/books/borrow/${id}`),\n  returnBook: id => axios.post(`/api/books/return/${id}`),\n  // Genres\n  getGenres: () => axios.get('/api/genres'),\n  // Stats\n  getStats: () => axios.get('/api/stats'),\n  // Reviews\n  getReviews: () => axios.get('/api/reviews'),\n  getBookReviews: bookId => axios.get(`/api/reviews/book/${bookId}`),\n  addReview: reviewData => axios.post('/api/reviews', reviewData),\n  deleteReview: (id, userId) => axios.delete(`/api/reviews/${id}`, {\n    data: {\n      userId\n    }\n  }),\n  likeReview: id => axios.post(`/api/reviews/${id}/like`),\n  // Users\n  getUsers: () => axios.get('/api/users'),\n  getUser: id => axios.get(`/api/users/${id}`),\n  updateUser: (id, userData) => axios.put(`/api/users/${id}`, userData),\n  createUser: userData => axios.post('/api/users', userData),\n  // Authentication (if implemented)\n  login: credentials => axios.post('/api/auth/login', credentials),\n  register: userData => axios.post('/api/auth/register', userData),\n  logout: () => axios.post('/api/auth/logout')\n};\nexport default apiService;","map":{"version":3,"names":["axios","defaults","baseURL","process","env","REACT_APP_API_URL","timeout","interceptors","request","use","config","token","localStorage","getItem","headers","Authorization","error","Promise","reject","response","_error$response","status","removeItem","window","location","href","initializeApp","booksResponse","genresResponse","statsResponse","all","get","books","data","genres","stats","pagination","console","totalBooks","availableBooks","borrowedBooks","totalGenres","apiService","getBooks","params","getBook","id","getBookContent","searchBooks","query","q","filterBooks","genre","borrowBook","post","returnBook","getGenres","getStats","getReviews","getBookReviews","bookId","addReview","reviewData","deleteReview","userId","delete","likeReview","getUsers","getUser","updateUser","userData","put","createUser","login","credentials","register","logout"],"sources":["C:/Users/kolas/Desktop/knigabel/client/src/services/appService.js"],"sourcesContent":["import axios from 'axios';\r\n\r\n// Configure axios defaults\r\naxios.defaults.baseURL = process.env.REACT_APP_API_URL || 'http://localhost:3000';\r\naxios.defaults.timeout = 10000;\r\n\r\n// Add request interceptor for authentication\r\naxios.interceptors.request.use(\r\n  (config) => {\r\n    // Add auth token if available\r\n    const token = localStorage.getItem('token');\r\n    if (token) {\r\n      config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Add response interceptor for error handling\r\naxios.interceptors.response.use(\r\n  (response) => response,\r\n  (error) => {\r\n    if (error.response?.status === 401) {\r\n      // Handle unauthorized access\r\n      localStorage.removeItem('token');\r\n      localStorage.removeItem('user');\r\n      window.location.href = '/';\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport const initializeApp = async () => {\r\n  try {\r\n    // Fetch initial library data\r\n    const [booksResponse, genresResponse, statsResponse] = await Promise.all([\r\n      axios.get('/api/books'),\r\n      axios.get('/api/genres'),\r\n      axios.get('/api/stats')\r\n    ]);\r\n\r\n    return {\r\n      books: booksResponse.data.books || [],\r\n      genres: genresResponse.data || [],\r\n      stats: statsResponse.data || {},\r\n      pagination: booksResponse.data.pagination || null\r\n    };\r\n  } catch (error) {\r\n    console.error('Failed to initialize app:', error);\r\n\r\n    // Return mock data if API is not available\r\n    return {\r\n      books: [],\r\n      genres: ['Все жанры', 'Роман-эпопея', 'Фантастика', 'Детектив'],\r\n      stats: {\r\n        totalBooks: 0,\r\n        availableBooks: 0,\r\n        borrowedBooks: 0,\r\n        totalGenres: 4\r\n      }\r\n    };\r\n  }\r\n};\r\n\r\nexport const apiService = {\r\n  // Books\r\n  getBooks: (params = {}) => axios.get('/api/books', { params }),\r\n  getBook: (id) => axios.get(`/api/books/${id}`),\r\n  getBookContent: (id) => axios.get(`/api/books/${id}/content`),\r\n  searchBooks: (query) => axios.get('/api/books/search', { params: { q: query } }),\r\n  filterBooks: (genre) => axios.get('/api/books/filter', { params: { genre } }),\r\n  borrowBook: (id) => axios.post(`/api/books/borrow/${id}`),\r\n  returnBook: (id) => axios.post(`/api/books/return/${id}`),\r\n\r\n  // Genres\r\n  getGenres: () => axios.get('/api/genres'),\r\n\r\n  // Stats\r\n  getStats: () => axios.get('/api/stats'),\r\n\r\n  // Reviews\r\n  getReviews: () => axios.get('/api/reviews'),\r\n  getBookReviews: (bookId) => axios.get(`/api/reviews/book/${bookId}`),\r\n  addReview: (reviewData) => axios.post('/api/reviews', reviewData),\r\n  deleteReview: (id, userId) => axios.delete(`/api/reviews/${id}`, { data: { userId } }),\r\n  likeReview: (id) => axios.post(`/api/reviews/${id}/like`),\r\n\r\n  // Users\r\n  getUsers: () => axios.get('/api/users'),\r\n  getUser: (id) => axios.get(`/api/users/${id}`),\r\n  updateUser: (id, userData) => axios.put(`/api/users/${id}`, userData),\r\n  createUser: (userData) => axios.post('/api/users', userData),\r\n\r\n  // Authentication (if implemented)\r\n  login: (credentials) => axios.post('/api/auth/login', credentials),\r\n  register: (userData) => axios.post('/api/auth/register', userData),\r\n  logout: () => axios.post('/api/auth/logout'),\r\n};\r\n\r\nexport default apiService;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}